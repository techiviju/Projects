<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="jakarta.tags.core"%>
<%@page isELIgnored="false"%>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>User Login</title>
<%@include file="component/allcss.jsp"%>

<style>
/* ====== Responsive Fullscreen Background ====== */
.login-bg {
  position: relative;
  width: 100%;
  min-height: 100vh;
  background: url('img/doc6.png') center top / cover no-repeat;
  display: flex;
  align-items: center;
  justify-content: center;
}

.login-bg::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 50, 130, 0.55);
  backdrop-filter: blur(3px);
  z-index: 0;
}

/* ====== Login Card ====== */
.login-card {
  position: relative;
  z-index: 1;
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 10px 35px rgba(0, 60, 150, 0.3);
  max-width: 420px;
  width: 100%;
  padding: 35px 25px;
  transition: all 0.3s ease;
  animation: fadeIn 0.8s ease-out;
}

.login-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 40px rgba(0, 80, 200, 0.4);
}

/* ====== Headings ====== */
.login-card h3 {
  color: #0056b3;
  font-weight: 700;
  letter-spacing: 0.5px;
}

/* ====== Buttons ====== */
.my-bg-color {
  background: linear-gradient(90deg, #007bff, #0056b3);
  border: none;
  font-weight: 600;
  border-radius: 8px;
  transition: all 0.3s ease;
}
.my-bg-color:hover {
  background: linear-gradient(90deg, #0056b3, #003d99);
  box-shadow: 0 0 12px rgba(0, 120, 255, 0.6);
  transform: translateY(-2px);
}

/* ====== Input Fields ====== */
.form-control {
  border-radius: 8px;
  padding: 10px 12px;
  border: 1px solid #d0d0d0;
  transition: all 0.25s ease;
}
.form-control:focus {
  border-color: #007bff;
  box-shadow: 0 0 8px rgba(0, 123, 255, 0.4);
}
.is-valid {
  border-color: #28a745 !important;
}
.is-invalid {
  border-color: #dc3545 !important;
}

/* ====== Fade-in Animation ====== */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ====== Responsive ====== */
@media (max-width: 768px) {
  .login-card {
    margin: 20px;
    padding: 25px 20px;
  }
  .login-bg {
    background-position: center center;
    background-size: cover;
  }
}
</style>

<script>
	function validateEmail() {
		const emailInput = document.getElementById("email");
		const emailError = document.getElementById("emailError");
		const emailPattern = /^(?!.*\.\.)[a-zA-Z0-9._%+-]{2,64}@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

		const emailValue = emailInput.value.trim();
		emailError.textContent = "";
		emailInput.classList.remove("is-invalid", "is-valid");

		if (emailValue === "") {
			emailError.textContent = "Email address is required.";
			emailInput.classList.add("is-invalid");
			return false;
		}

		if (!emailPattern.test(emailValue)) {
			emailError.textContent = "Please enter a valid email address (e.g., user@example.com)";
			emailInput.classList.add("is-invalid");
			return false;
		}

		emailInput.classList.add("is-valid");
		return true;
	}

	document.addEventListener("DOMContentLoaded", function() {
		const form = document.querySelector("form");
		const emailField = document.getElementById("email");

		if (emailField) {
			emailField.addEventListener("input", validateEmail);
		}

		if (form) {
			form.addEventListener("submit", function(e) {
				if (!validateEmail()) {
					e.preventDefault();
					emailField.focus();
				}
			});
		}
	});

	function validatePassword() {
	    const passwordInput = document.getElementById("password");
	    const passwordError = document.getElementById("passwordError");
	    const passwordValue = passwordInput.value.trim();

	    const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

	    passwordError.textContent = "";
	    passwordInput.classList.remove("is-invalid", "is-valid");

	    if (passwordValue === "") {
	      passwordError.textContent = "Password is required.";
	      passwordInput.classList.add("is-invalid");
	      return false;
	    }

	    if (!passwordPattern.test(passwordValue)) {
	      passwordError.textContent = 
	        "Password must be at least 8 characters and include uppercase, lowercase, number, and special character.";
	      passwordInput.classList.add("is-invalid");
	      return false;
	    }

	    passwordInput.classList.add("is-valid");
	    return true;
	}

	document.addEventListener("DOMContentLoaded", function() {
	    const form = document.querySelector("form");
	    const passwordField = document.getElementById("password");

	    if (passwordField) {
	      passwordField.addEventListener("input", validatePassword);
	    }

	    if (form) {
	      form.addEventListener("submit", function(e) {
	        if (!validatePassword()) {
	          e.preventDefault();
	          passwordField.focus();
	        }
	      });
	    }
	});
</script>
</head>

<body>
	<%@include file="component/navbar.jsp"%>

	<!-- Background Wrapper -->
	<div class="login-bg">
		<div class="card login-card">
			<div class="card-body">
				<h3 class="text-center mb-4">
					<i class="fa fa-user-circle me-2"></i> User Login
				</h3>

				<!-- Alerts -->
				<c:if test="${not empty successMsg }">
					<div class="alert alert-success text-center">${successMsg}</div>
					<c:remove var="successMsg" scope="session" />
				</c:if>
				<c:if test="${not empty errorMsg }">
					<div class="alert alert-danger text-center">${errorMsg}</div>
					<c:remove var="errorMsg" scope="session" />
				</c:if>

				<!-- Login Form -->
				<form action="userLogin" method="post">
					<div class="mb-3">
						<label class="form-label">Email address</label>
						<input required id="email" name="email" type="email"
							placeholder="Enter Email" class="form-control" maxlength="75"
							title="Please enter a valid email address (e.g., user@example.com)">
						<div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div>
						<div id="emailError" class="text-danger mt-1" style="font-size: 0.9em;"></div>
					</div>

					<div class="mb-3">
						<label class="form-label">Password</label>
						<input required id="password" name="password" type="password"
							placeholder="Enter password" class="form-control" minlength="8">
						<div id="passwordError" class="text-danger mt-1" style="font-size: 0.9em;"></div>
					</div>

					<button type="submit" class="btn my-bg-color text-white w-100 mt-3">
						Login
					</button>
				</form>

				<div class="text-center mt-3">
					<small>Don't have an account? 
						<a href="signup.jsp" class="text-decoration-none myP-color">Create one</a>
					</small>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
