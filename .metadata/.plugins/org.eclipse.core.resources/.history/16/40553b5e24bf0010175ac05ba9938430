<%@page import="com.hms.entity.Appointment"%>
<%@page import="com.hms.db.DBConnection"%>
<%@page import="com.hms.dao.AppointmentDAO"%>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="jakarta.tags.core" %>
<%@ page isELIgnored="false" %>
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Doctor Comment / Prescription</title>
  <%@include file="../component/allcss.jsp" %>
  <style>
    .my-bg-img {
      background: linear-gradient(rgba(11,85,98,0.46), rgba(226,75,106,0.36)), url("../img/hospital1.jpg");
      height: 20vh;
      width: 100%;
      background-size: cover;
      background-position: center;
      border-radius: 14px;
      box-shadow: 0 4px 28px rgba(11,85,98,0.13);
      margin-bottom: 3rem;
    }
    .my-card {
      border-radius: 14px;
      box-shadow: 0 8px 32px rgba(11,85,98,0.085);
      border: none;
      background: #fff;
      padding: 2rem;
    }
    .form-label {
      font-weight: 600;
      color: #0b5562;
    }
    .btn-success {
      background: linear-gradient(90deg, #13b786 50%, #63d471 100%);
      font-weight: 600;
      border-radius: 10px;
      border: none;
      box-shadow: 0 2px 18px rgba(19,183,134,0.07);
      font-size: 1.15rem;
    }
    .btn-success:hover {
      background: linear-gradient(90deg, #63d471 50%, #13b786 100%);
    }
  </style>
</head>
<body>
	<%@ include file="../component/navbar.jsp" %>

<c:if test="${empty doctorObj}">
  <c:redirect url="../doctor_login.jsp"/>
</c:if>
<div class="container-fluid my-bg-img d-flex align-items-center justify-content-center">
  <p class="fs-2 text-white fw-bold w-100 text-center">Leave a Treatment Comment</p>
</div>
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-7 col-md-8">
      <div class="card my-card">
        <div class="card-body">
          <!-- Success & Error Messages -->
          <c:if test="${not empty successMsg}">
            <div class="alert alert-success text-center">${successMsg}</div>
            <c:remove var="successMsg" scope="session"/>
          </c:if>
          <c:if test="${not empty errorMsg}">
            <div class="alert alert-danger text-center">${errorMsg}</div>
            <c:remove var="errorMsg" scope="session"/>
          </c:if>
          <%
            int id = Integer.parseInt(request.getParameter("id"));
            AppointmentDAO appDAO = new AppointmentDAO(DBConnection.getConn());
            Appointment appointment = appDAO.getAppointmentById(id);
          %>
          <form class="row g-3 mt-2" action="../updateStatus" method="post">
            <div class="col-md-6">
              <label class="form-label">Full Name</label>
              <input name="fullName" type="text" class="form-control" readonly value="<%= appointment.getFullName()%>">
            </div>
            <div class="col-md-6">
              <label class="form-label">Age</label>
              <input name="age" type="number" class="form-control" readonly value="<%= appointment.getAge()%>">
            </div>
            <div class="col-md-6">
              <label class="form-label">Phone</label>
              <input name="phone" type="number" maxlength="11" class="form-control" readonly value="<%= appointment.getPhone()%>">
            </div>
            <div class="col-md-6">
              <label class="form-label">Diseases</label>
              <input name="diseases" type="text" class="form-control" readonly value="<%= appointment.getDiseases()%>">
            </div>
            <div class="col-md-12">
              <label class="form-label">Leave a Comment / Prescription</label>
              <textarea name="comment" class="form-control" rows="3" placeholder="Type your treatment notes or prescription here..." required></textarea>
            </div>
            <input type="hidden" name="id" value="<%= appointment.getId()%>">
            <input type="hidden" name="doctorId" value="<%= appointment.getDoctorId()%>">
            <div class="col-md-12 mt-1">
              <button type="submit" class="btn btn-success w-100">Submit Treatment Comment</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<%@ include file="../component/footer.jsp" %>
</body>
</html>
